{"ast":null,"code":"var _jsxFileName = \"/Users/sejlaali/General_Assembly/sei/12-week/01-monday/project4/kosovo-1/client/src/components/Reviews.js\";\nimport React, { Component } from \"react\";\nimport axios from \"axios\";\nimport { Link } from \"react-router-dom\";\nimport ReviewForm from \"./ReviewForm\";\nimport \"./Reviews.css\";\nimport Button from \"react-bootstrap/Button\";\n\nclass Reviews extends Component {\n  constructor(props) {\n    super(props);\n\n    this.getAvgRating = () => {\n      const ratings = this.state.ratings;\n      this.state.reviews.map(review => {\n        ratings.push(review.rating);\n      });\n      let total = 0;\n\n      for (let i = 0; i < ratings.length; i++) {\n        total += ratings[i];\n      }\n\n      let avgRating = Math.ceil(total / ratings.length);\n      this.setState({\n        avgRating\n      });\n    };\n\n    this.getAllReviews = async () => {\n      const res = await axios.get(\"http://localhost:3000/posts/\".concat(this.props.match.params.id, \"/reviews\"));\n      const reviews = res.data;\n      this.setState({\n        reviews,\n        id: this.props.match.params.id\n      });\n      this.matchIds();\n      this.getAvgRating();\n    };\n\n    this.handleReviewClick = () => {\n      if (!this.props.isSignedIn) {\n        alert(\"Please log in or sign up to write a review.\");\n      } else {\n        this.setState({\n          form: !this.state.form\n        });\n      }\n    };\n\n    this.matchIds = async () => {\n      const currentUserId = localStorage.getItem(\"uid\");\n      const res = await axios.get(\"http://localhost:3000/users\");\n      const data = res.data;\n      const currentUser = data.filter(item => item.email === currentUserId);\n      this.setState({\n        currentUser: currentUser[0]\n      });\n    };\n\n    this.handleReviewDelete = async id => {\n      await axios.delete(\"http://localhost:3000/posts/\".concat(this.props.match.params.id, \"/reviews/\").concat(id));\n      this.props.history.push(\"/activities\");\n    };\n\n    this.state = {\n      reviews: [],\n      form: false,\n      currentUser: {},\n      id: null,\n      avgRating: 0,\n      ratings: []\n    };\n  }\n\n  componentDidMount() {\n    this.getAllReviews();\n  }\n\n  render() {\n    const _this$state = this.state,\n          currentUser = _this$state.currentUser,\n          avgRating = _this$state.avgRating;\n    const renderReviews = this.state.reviews.map(review => {\n      if (this.state.currentUser && review.user_id === currentUser.id) {\n        return React.createElement(\"div\", {\n          className: \"single-review-container\",\n          style: {\n            border: \"1px solid black\"\n          },\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 85\n          },\n          __self: this\n        }, React.createElement(\"h3\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 89\n          },\n          __self: this\n        }, review.title), React.createElement(\"p\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 90\n          },\n          __self: this\n        }, \"Rating: \", review.rating, \" out of 5\"), React.createElement(\"p\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 91\n          },\n          __self: this\n        }, review.review_text), React.createElement(\"p\", {\n          className: \"written-by\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 92\n          },\n          __self: this\n        }, \"Written by: \", review.first_name, \" \", review.last_name), React.createElement(Link, {\n          to: \"/activity/\".concat(this.props.match.params.id, \"/reviews/\").concat(review.id, \"/edit\"),\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 95\n          },\n          __self: this\n        }, React.createElement(Button, {\n          style: {\n            marginRight: \"5px\"\n          },\n          variant: \"info\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 100\n          },\n          __self: this\n        }, \"Edit\")), React.createElement(Button, {\n          onClick: () => this.handleReviewDelete(\"\".concat(review.id)),\n          variant: \"danger\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 104\n          },\n          __self: this\n        }, \"Delete\"));\n      } else {\n        return React.createElement(\"div\", {\n          className: \"single-review-container\",\n          style: {\n            border: \"1px solid  black\"\n          },\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 114\n          },\n          __self: this\n        }, React.createElement(\"h2\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 118\n          },\n          __self: this\n        }, review.title), React.createElement(\"p\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 119\n          },\n          __self: this\n        }, \"Rating: \", review.rating, \" out of 5\"), React.createElement(\"p\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 120\n          },\n          __self: this\n        }, review.review_text), React.createElement(\"p\", {\n          className: \"written-by\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 121\n          },\n          __self: this\n        }, \"Written by: \", review.first_name, \" \", review.last_name));\n      }\n    });\n    const rating = this.state.avgRating == 0 ? React.createElement(\"span\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 131\n      },\n      __self: this\n    }, this.state.avgRating) : React.createElement(\"span\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 133\n      },\n      __self: this\n    }, \"0\");\n    return React.createElement(\"div\", {\n      className: \"reviews-container\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 137\n      },\n      __self: this\n    }, this.state.form ? React.createElement(ReviewForm, {\n      id: this.state.id,\n      handleReviewClick: this.handleReviewClick,\n      getAllReviews: this.getAllReviews,\n      isSignedIn: this.props.isSignedIn,\n      isUpdateForm: false,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 139\n      },\n      __self: this\n    }) : null, React.createElement(\"div\", {\n      style: {\n        paddingTop: \"20px\"\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 147\n      },\n      __self: this\n    }, React.createElement(\"p\", {\n      className: \"avg-rating\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 148\n      },\n      __self: this\n    }, \"Average Rating: \", React.createElement(\"span\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 149\n      },\n      __self: this\n    }, rating)), React.createElement(Button, {\n      onClick: this.handleReviewClick,\n      variant: \"primary\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 151\n      },\n      __self: this\n    }, \"Write a Review!\"), React.createElement(Link, {\n      to: \"/activities\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 154\n      },\n      __self: this\n    }, React.createElement(Button, {\n      style: {\n        display: \"block\",\n        margin: \"7px auto\",\n        fontSize: \"12px\"\n      },\n      variant: \"light\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 155\n      },\n      __self: this\n    }, \"Back to Activities\")), renderReviews));\n  }\n\n}\n\nexport default Reviews;","map":{"version":3,"sources":["/Users/sejlaali/General_Assembly/sei/12-week/01-monday/project4/kosovo-1/client/src/components/Reviews.js"],"names":["React","Component","axios","Link","ReviewForm","Button","Reviews","constructor","props","getAvgRating","ratings","state","reviews","map","review","push","rating","total","i","length","avgRating","Math","ceil","setState","getAllReviews","res","get","match","params","id","data","matchIds","handleReviewClick","isSignedIn","alert","form","currentUserId","localStorage","getItem","currentUser","filter","item","email","handleReviewDelete","delete","history","componentDidMount","render","renderReviews","user_id","border","title","review_text","first_name","last_name","marginRight","paddingTop","display","margin","fontSize"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\nimport axios from \"axios\";\nimport { Link } from \"react-router-dom\";\nimport ReviewForm from \"./ReviewForm\";\nimport \"./Reviews.css\";\nimport Button from \"react-bootstrap/Button\";\nclass Reviews extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      reviews: [],\n      form: false,\n      currentUser: {},\n      id: null,\n      avgRating: 0,\n      ratings: []\n    };\n  }\n\n  getAvgRating = () => {\n    const { ratings } = this.state;\n    this.state.reviews.map(review => {\n      ratings.push(review.rating);\n    });\n    let total = 0;\n    for (let i = 0; i < ratings.length; i++) {\n      total += ratings[i];\n    }\n    let avgRating = Math.ceil(total / ratings.length);\n    this.setState({\n      avgRating\n    });\n  };\n\n  getAllReviews = async () => {\n    const res = await axios.get(\n      `http://localhost:3000/posts/${this.props.match.params.id}/reviews`\n    );\n    const reviews = res.data;\n    this.setState({\n      reviews,\n      id: this.props.match.params.id\n    });\n    this.matchIds();\n    this.getAvgRating();\n  };\n\n  componentDidMount() {\n    this.getAllReviews();\n  }\n\n  handleReviewClick = () => {\n    if (!this.props.isSignedIn) {\n      alert(\"Please log in or sign up to write a review.\");\n    } else {\n      this.setState({\n        form: !this.state.form\n      });\n    }\n  };\n\n  matchIds = async () => {\n    const currentUserId = localStorage.getItem(\"uid\");\n    const res = await axios.get(`http://localhost:3000/users`);\n    const data = res.data;\n    const currentUser = data.filter(item => item.email === currentUserId);\n    this.setState({\n      currentUser: currentUser[0]\n    });\n  };\n\n  handleReviewDelete = async id => {\n    await axios.delete(\n      `http://localhost:3000/posts/${this.props.match.params.id}/reviews/${id}`\n    );\n    this.props.history.push(\"/activities\");\n  };\n\n  render() {\n    const { currentUser, avgRating } = this.state;\n\n    const renderReviews = this.state.reviews.map(review => {\n      if (this.state.currentUser && review.user_id === currentUser.id) {\n        return (\n          <div\n            className=\"single-review-container\"\n            style={{ border: \"1px solid black\" }}\n          >\n            <h3>{review.title}</h3>\n            <p>Rating: {review.rating} out of 5</p>\n            <p>{review.review_text}</p>\n            <p className=\"written-by\">\n              Written by: {review.first_name} {review.last_name}\n            </p>\n            <Link\n              to={`/activity/${this.props.match.params.id}/reviews/${\n                review.id\n              }/edit`}\n            >\n              <Button style={{ marginRight: \"5px\" }} variant=\"info\">\n                Edit\n              </Button>\n            </Link>\n            <Button\n              onClick={() => this.handleReviewDelete(`${review.id}`)}\n              variant=\"danger\"\n            >\n              Delete\n            </Button>\n          </div>\n        );\n      } else {\n        return (\n          <div\n            className=\"single-review-container\"\n            style={{ border: \"1px solid  black\" }}\n          >\n            <h2>{review.title}</h2>\n            <p>Rating: {review.rating} out of 5</p>\n            <p>{review.review_text}</p>\n            <p className=\"written-by\">\n              Written by: {review.first_name} {review.last_name}\n            </p>\n          </div>\n        );\n      }\n    });\n\n    const rating =\n      this.state.avgRating == 0 ? (\n        <span>{this.state.avgRating}</span>\n      ) : (\n        <span>0</span>\n      );\n\n    return (\n      <div className=\"reviews-container\">\n        {this.state.form ? (\n          <ReviewForm\n            id={this.state.id}\n            handleReviewClick={this.handleReviewClick}\n            getAllReviews={this.getAllReviews}\n            isSignedIn={this.props.isSignedIn}\n            isUpdateForm={false}\n          />\n        ) : null}\n        <div style={{ paddingTop: \"20px\" }}>\n          <p className=\"avg-rating\">\n            Average Rating: <span>{rating}</span>\n          </p>\n          <Button onClick={this.handleReviewClick} variant=\"primary\">\n            Write a Review!\n          </Button>\n          <Link to=\"/activities\">\n            <Button\n              style={{ display: \"block\", margin: \"7px auto\", fontSize: \"12px\" }}\n              variant=\"light\"\n            >\n              Back to Activities\n            </Button>\n          </Link>\n          {renderReviews}\n        </div>\n      </div>\n    );\n  }\n}\n\nexport default Reviews;\n"]},"metadata":{},"sourceType":"module"}